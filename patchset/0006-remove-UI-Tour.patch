From 34372306cfa209c82b02da3efcb529cd51b48bb9 Mon Sep 17 00:00:00 2001
From: torvic9 <torvic9@mailbox.org>
Date: Sun, 6 Oct 2019 11:24:49 +0200
Subject: [PATCH] remove UI Tour

Signed-off-by: torvic9 <torvic9@mailbox.org>
---
 browser/base/content/browser.css       | 65 --------------------------
 browser/base/content/browser.js        |  1 -
 browser/base/content/browser.xhtml     | 36 --------------
 browser/base/content/utilityOverlay.js |  6 ---
 browser/components/BrowserGlue.jsm     | 18 -------
 browser/components/moz.build           |  1 -
 6 files changed, 127 deletions(-)

diff --git a/browser/base/content/browser.css b/browser/base/content/browser.css
index f5ffb29c93..db6e9acd3c 100644
--- a/browser/base/content/browser.css
+++ b/browser/base/content/browser.css
@@ -1280,73 +1280,8 @@ toolbarpaletteitem > toolbaritem {
 :root[customizing=true] .panel-banner-item {
   display: none;
 }
 
-/* UI Tour */
-
-@keyframes uitour-wobble {
-  from {
-    transform: rotate(0deg) translateX(3px) rotate(0deg);
-  }
-  50% {
-    transform: rotate(360deg) translateX(3px) rotate(-360deg);
-  }
-  to {
-    transform: rotate(720deg) translateX(0px) rotate(-720deg);
-  }
-}
-
-@keyframes uitour-zoom {
-  from {
-    transform: scale(0.8);
-  }
-  50% {
-    transform: scale(1.0);
-  }
-  to {
-    transform: scale(0.8);
-  }
-}
-
-@keyframes uitour-color {
-  from {
-    border-color: #5B9CD9;
-  }
-  50% {
-    border-color: #FF0000;
-  }
-  to {
-    border-color: #5B9CD9;
-  }
-}
-
-#UITourHighlightContainer,
-#UITourHighlight {
-  pointer-events: none;
-}
-
-#UITourHighlight[active] {
-  animation-delay: 2s;
-  animation-fill-mode: forwards;
-  animation-iteration-count: infinite;
-  animation-timing-function: linear;
-}
-
-#UITourHighlight[active="wobble"] {
-  animation-name: uitour-wobble;
-  animation-delay: 0s;
-  animation-duration: 1.5s;
-  animation-iteration-count: 1;
-}
-#UITourHighlight[active="zoom"] {
-  animation-name: uitour-zoom;
-  animation-duration: 1s;
-}
-#UITourHighlight[active="color"] {
-  animation-name: uitour-color;
-  animation-duration: 2s;
-}
-
 /* Combined context-menu items */
 #context-navigation > .menuitem-iconic > .menu-iconic-text,
 #context-navigation > .menuitem-iconic > .menu-accel-container {
   display: none;
diff --git a/browser/base/content/browser.js b/browser/base/content/browser.js
index 160f569d1e..78acefd31f 100644
--- a/browser/base/content/browser.js
+++ b/browser/base/content/browser.js
@@ -72,9 +72,8 @@ XPCOMUtils.defineLazyModuleGetters(this, {
   TabModalPrompt: "chrome://global/content/tabprompts.jsm",
   TabCrashHandler: "resource:///modules/ContentCrashHandlers.jsm",
   TelemetryEnvironment: "resource://gre/modules/TelemetryEnvironment.jsm",
   Translation: "resource:///modules/translation/Translation.jsm",
-  UITour: "resource:///modules/UITour.jsm",
   UpdateUtils: "resource://gre/modules/UpdateUtils.jsm",
   UrlbarInput: "resource:///modules/UrlbarInput.jsm",
   UrlbarPrefs: "resource:///modules/UrlbarPrefs.jsm",
   UrlbarTokenizer: "resource:///modules/UrlbarTokenizer.jsm",
diff --git a/browser/base/content/browser.xhtml b/browser/base/content/browser.xhtml
index 0015cecc7a..e441578cdb 100644
--- a/browser/base/content/browser.xhtml
+++ b/browser/base/content/browser.xhtml
@@ -316,44 +316,8 @@
 #endif
       </hbox>
     </panel>
 
-    <!-- UI tour experience -->
-    <panel id="UITourTooltip"
-           type="arrow"
-           hidden="true"
-           noautofocus="true"
-           noautohide="true"
-           align="start"
-           orient="vertical"
-           role="alert">
-     <vbox>
-      <hbox id="UITourTooltipBody">
-        <image id="UITourTooltipIcon"/>
-        <vbox flex="1">
-          <hbox id="UITourTooltipTitleContainer">
-            <label id="UITourTooltipTitle" flex="1"/>
-            <toolbarbutton id="UITourTooltipClose" class="close-icon"
-                           tooltiptext="&uiTour.infoPanel.close;"/>
-          </hbox>
-          <description id="UITourTooltipDescription" flex="1"/>
-        </vbox>
-      </hbox>
-      <hbox id="UITourTooltipButtons" flex="1" align="center"/>
-     </vbox>
-    </panel>
-    <!-- type="default" forces frames to be created so that the panel's size can be determined -->
-    <panel id="UITourHighlightContainer"
-           type="default"
-           hidden="true"
-           noautofocus="true"
-           noautohide="true"
-           flip="none"
-           consumeoutsideclicks="false"
-           mousethrough="always">
-      <box id="UITourHighlight"></box>
-    </panel>
-
     <panel id="sidebarMenu-popup"
            class="cui-widget-panel"
            role="group"
            type="arrow"
diff --git a/browser/base/content/utilityOverlay.js b/browser/base/content/utilityOverlay.js
index 7180d0829b..a6931738bb 100644
--- a/browser/base/content/utilityOverlay.js
+++ b/browser/base/content/utilityOverlay.js
@@ -1087,14 +1087,8 @@ function openFeedbackPage() {
   var url = Services.urlFormatter.formatURLPref("app.feedback.baseURL");
   openTrustedLinkIn(url, "tab");
 }
 
-function openTourPage() {
-  let scope = {};
-  ChromeUtils.import("resource:///modules/UITour.jsm", scope);
-  openTrustedLinkIn(scope.UITour.url, "tab");
-}
-
 function buildHelpMenu() {
   document.getElementById(
     "feedbackPage"
   ).disabled = !Services.policies.isAllowed("feedbackCommands");
diff --git a/browser/components/BrowserGlue.jsm b/browser/components/BrowserGlue.jsm
index c087ccb7eb..6c42d3a210 100644
--- a/browser/components/BrowserGlue.jsm
+++ b/browser/components/BrowserGlue.jsm
@@ -321,18 +321,8 @@ let LEGACY_ACTORS = {
       matches: ["about:studies"],
     },
   },
 
-  UITour: {
-    child: {
-      module: "resource:///modules/UITourChild.jsm",
-      events: {
-        mozUITour: { wantUntrusted: true },
-      },
-      permissions: ["uitour"],
-    },
-  },
-
   URIFixup: {
     child: {
       module: "resource:///actors/URIFixupChild.jsm",
       group: "browsers",
@@ -507,9 +497,8 @@ XPCOMUtils.defineLazyModuleGetters(this, {
   ShellService: "resource:///modules/ShellService.jsm",
   TabCrashHandler: "resource:///modules/ContentCrashHandlers.jsm",
   TabUnloader: "resource:///modules/TabUnloader.jsm",
   UIState: "resource://services-sync/UIState.jsm",
-  UITour: "resource:///modules/UITour.jsm",
   WebChannel: "resource://gre/modules/WebChannel.jsm",
   WindowsRegistry: "resource://gre/modules/WindowsRegistry.jsm",
 });
 
@@ -4240,15 +4229,8 @@ var JawsScreenReaderVersionCheck = {
     );
   },
 };
 
-// Listen for UITour messages.
-// Do it here instead of the UITour module itself so that the UITour module is lazy loaded
-// when the first message is received.
-Services.mm.addMessageListener("UITour:onPageEvent", function(aMessage) {
-  UITour.onPageEvent(aMessage, aMessage.data);
-});
-
 // Listen for HybridContentTelemetry messages.
 // Do it here instead of HybridContentTelemetry.init() so that
 // the module can be lazily loaded on the first message.
 Services.mm.addMessageListener(
diff --git a/browser/components/moz.build b/browser/components/moz.build
index 4195a30a5d..338ad508c0 100644
--- a/browser/components/moz.build
+++ b/browser/components/moz.build
@@ -50,9 +50,8 @@ DIRS += [
     'search',
     'sessionstore',
     'shell',
     'syncedtabs',
-    'uitour',
     'urlbar',
     'translation',
 ]
 
-- 
2.23.0

